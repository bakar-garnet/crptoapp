name: Garnet CI Monitoring

on:
  push:
    branches: [ main ]

jobs:
  monitor:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4

      # ‚úÖ EXACT snippet
      - name: Add Garnet Monitor
        uses: garnet-org/action@v1
        with:
          api_token: ${{ secrets.GARNET_API_TOKEN }}

      # üî• No-deps ‚Äúbehavior soup‚Äù (should create file/exec/network/env events)
      - name: Generate runtime behaviors
        shell: bash
        run: |
          set -euxo pipefail

          # file reads
          cat /etc/os-release || true
          cat /etc/passwd || true
          cat /proc/cpuinfo | head -n 30 || true
          cat /proc/self/environ | tr '\0' '\n' | head -n 30 || true

          # exec + shell spawn
          id || true
          whoami || true
          uname -a || true
          ps aux | head -n 10 || true
          bash -lc 'echo shell_spawned && env | head -n 20' || true

          # network (dns + http)
          curl -I https://example.com || true
          curl -I https://api.github.com || true
          getent hosts example.com || true
