name: Garnet CI Monitoring

on:
  push:
    branches: [ main ]
  pull_request:
    branches: [ main ]

jobs:
  monitor:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4

      - name: Add Garnet Monitor
        uses: garnet-org/action@v1
        with:
          api_token: ${{ secrets.GARNET_API_TOKEN }}

      - name: Post-monitor proof
        run: |
          echo "MONITOR INSTALLED - NOW RUNNING WORKLOAD"
          id
          uname -a
          ps aux | head

      - name: Install + build + test (noisy but normal)
        run: |
          node -v
          npm -v
          npm ci || npm install
          npm run build --if-present
          npm test --if-present
          python3 -V || true
          pip3 -V || true

